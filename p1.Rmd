---
title: "Project 1 - Helicopters!"
author: "Jaskaran Singh, Michael Sarkis, Jack McCarthy"
date: "3/1/2022"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(matrixStats)
library(kableExtra)
library(daewr)
knitr::opts_chunk$set(echo=TRUE)
```

# Introduction

The aim of this project is to optimize certain design parameters for the 
construction of a series of helicopter toys. The ideal result is a helicopter 
design that maximizes hang-time with minimal variance in the times across drops. 
However, as the budget is limited for the testing of various designs, we cannot 
perform more than 100 drops across all candidate designs. It is important that 
we perform these test drops in as economical a fashion as possible--that is, we 
would like to extract the most information possible about the effects of 
specific design decisions from each trial run as we can.

A factorial or fractional factorial experimental design is well-suited to a 
situation like this. Through this procedure, we may define factors with levels 
that represent different values of the design parameters of interest. Then, 
having collected data replicates for each specified combination of factor 
levels, we may perform an analysis to ascertain the effect of each factor along 
with the effects of possible interactions between factors. Knowing these effects 
will allow us to determine the optimal design having maximal hang-time and 
minimal variance.

# Design

A few test runs were performed to better understand how to make the helicopters 
and determined what changes to the design might impact the performance. Given 
the results from these tests, the following factors will considered in the 
construction of each candidate helicopter design:

|**Factor** |  **Description**  | **Low (-)** | **High (+)** |
|:---------:|-------------------|-------------|--------------|
|     A     | Total size        | 6.5"        | 11.0"        |
|     B     | Blade length      | 4.75"       | 5.75"        |
|     C     | Blade width       | 2.1"        | 3.0"         |
|     D     | Stabilizer length | 2.75"       | 4.75"        |
|     E     | Stabilizer width  | 0.5".        | 1.25"        |

For convenience we are referring to the bottom section of the helicopter that 
extends downward beneath the blades as the "stabilizer". We also noted during 
our initial tests that taping the bottom of the stabilizer is universally 
beneficial to the hang-time and stability of the helicopter. We will therefore 
being applying tape in all designs.

We have elected to conduct a $2_V^{5-1}$ fractional factorial experiment to 
analyze the effects of these factors on the hang-time. The generator for this 
experiment is $I=ABCDE$, which gives the following design table:

| **A** | **B** | **C** | **D** | **E** | 1 | 2 | 3 | 4 | 5 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| - | - | - | - | + | 5.05 | 3.61 | 4.20 | 4.20 | 4.72 |
| - | - | - | + | - | 2.84 | 3.94 | 3.30 | 4.45 | 4.39 |
| - | - | + | - | - | 3.29 | 3.35 | 3.68 | 3.68 | 3.93 |
| - | - | + | + | + | 4.12 | 3.67 | 4.66 | 3.36 | 4.08 |
| - | + | - | - | - | 3.35 | 3.74 | 3.55 | 3.93 | 4.21 |
| - | + | - | + | + | 4.13 | 3.95 | 3.54 | 4.72 | 4.06 |
| - | + | + | - | + | 3.21 | 3.54 | 3.22 | 3.29 | 4.52 |
| - | + | + | + | - | 4.39 | 5.31 | 4.32 | 4.85 | 6.16 |
| + | - | - | - | - | 4.13 | 4.27 | 4.13 | 3.35 | 3.74 |
| + | - | - | + | + | 3.80 | 3.68 | 3.15 | 3.34 | 3.54 |
| + | - | + | - | + | 4.08 | 3.87 | 3.55 | 4.32 | 4.07 |
| + | - | + | + | - | 3.69 | 3.36 | 4.21 | 3.42 | 3.88 |
| + | + | - | - | + | 5.83 | 5.58 | 5.96 | 6.16 | 6.53 |
| + | + | - | + | - | 3.84 | 3.62 | 4.72 | 4.66 | 4.26 |
| + | + | + | - | - | 3.66 | 3.42 | 4.27 | 3.47 | 3.36 |
| + | + | + | + | + | 3.61 | 3.68 | 4.14 | 4.19 | 3.74 |

```{r}
flight_data <- read_excel("flight data.xlsx")
flight_data <- flight_data %>% mutate(ybar = (Time1+Time2+Time3+Time4+Time5)/5)
flight_data$s = rowVars(as.matrix(flight_data[,c(6,7,8,9,10)]))
flight_data$lns = log(flight_data$s)

```
```{r}
me1 <- flight_data %>% filter(A == "+") %>% select(ybar,lns)
me2 <-flight_data %>% filter(A == "-") %>% select(ybar,lns)

ybarA <- mean(me1$ybar) - mean(me2$ybar)
lnsA <- mean(me1$lns) - mean(me2$lns)

me1 <- flight_data %>% filter(B == "+") %>% select(ybar,lns)
me2 <-flight_data %>% filter(B == "-") %>% select(ybar,lns)

ybarB <- mean(me1$ybar) - mean(me2$ybar)
lnsB <- mean(me1$lns) - mean(me2$lns)

me1 <- flight_data %>% filter(C == "+") %>% select(ybar,lns)
me2 <-flight_data %>% filter(C == "-") %>% select(ybar,lns)

ybarC <- mean(me1$ybar) - mean(me2$ybar)
lnsC <- mean(me1$lns) - mean(me2$lns)

me1 <- flight_data %>% filter(D == "+") %>% select(ybar,lns)
me2 <-flight_data %>% filter(D == "-") %>% select(ybar,lns)

ybarD <- mean(me1$ybar) - mean(me2$ybar)
lnsD <- mean(me1$lns) - mean(me2$lns)

me1 <- flight_data %>% filter(E == "+") %>% select(ybar,lns)
me2 <-flight_data %>% filter(E == "-") %>% select(ybar,lns)

ybarE <- mean(me1$ybar) - mean(me2$ybar)
lnsE <- mean(me1$lns) - mean(me2$lns)
```

```{r}
in1 <- flight_data %>% filter(A == "+",B == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(A == "-",B == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(A == "+",B == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(A == "-",B == "+") %>% select(ybar,lns)
ybarAB <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsAB <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(A == "+",C == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(A == "-",C == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(A == "+",C == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(A == "-",C == "+") %>% select(ybar,lns)
ybarAC <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsAC <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(A == "+",D == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(A == "-",D == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(A == "+",D == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(A == "-",D == "+") %>% select(ybar,lns)
ybarAD <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsAD <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(A == "+",E == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(A == "-",E == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(A == "+",E == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(A == "-",E == "+") %>% select(ybar,lns)
ybarAE <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsAE <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(B == "+",C == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(B == "-",C == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(B == "+",C == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(B == "-",C == "+") %>% select(ybar,lns)
ybarBC <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsBC <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(B == "+",D == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(B == "-",D == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(B == "+",D == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(B == "-",D == "+") %>% select(ybar,lns)
ybarBD <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsBD <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(B == "+",E == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(B == "-",E == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(B == "+",E == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(B == "-",E == "+") %>% select(ybar,lns)
ybarBE <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsBE <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(C == "+",D == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(C == "-",D == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(C == "+",D == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(C == "-",D == "+") %>% select(ybar,lns)
ybarCD <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsCD <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))

in1 <- flight_data %>% filter(C == "+",E == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(C == "-",E == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(C == "+",E == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(C == "-",E == "+") %>% select(ybar,lns)
ybarCE <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsCE <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))


in1 <- flight_data %>% filter(D == "+",E == "+") %>% select(ybar,lns)
in2 <- flight_data %>% filter(D == "-",E == "-") %>% select(ybar,lns)
in3 <- flight_data %>% filter(D == "+",E == "-") %>% select(ybar,lns)
in4 <- flight_data %>% filter(D == "-",E == "+") %>% select(ybar,lns)
ybarDE <- .5*(mean(in1$ybar)+mean(in2$ybar))- .5*(mean(in3$ybar)+mean(in4$ybar))
lnsDE <- .5*(mean(in1$lns)+mean(in2$lns))- .5*(mean(in3$lns)+mean(in4$lns))
```


```{r}
lnss <- c(lnsA,lnsB,lnsC,lnsD,lnsE,lnsAB,lnsAC,lnsAD,lnsAE,lnsBC,lnsBD,lnsBE,lnsCD,lnsCE,lnsDE)
ybars <- c(ybarA,ybarB,ybarC,ybarD,ybarE,ybarAB,ybarAC,ybarAD,ybarAE,ybarBC,ybarBD,ybarBE,ybarCD,ybarCE,ybarDE)
names(ybars) <-c("A","B","C","D","E","AB","AC","AD","AE","BC","BD","BE","CD","CE","DE")
names(lnss) <-c("A","B","C","D","E","AB","AC","AD","AE","BC","BD","BE","CD","CE","DE")
```
```{r}
halfnorm(ybars,labs = names(ybar))
#B nad C appear to be in the top right corner and may be significant
halfnorm(lnss,labs = names(lnss))
#A is the highest dispersion and AB is the second highest, but everything appear to be linear
```


