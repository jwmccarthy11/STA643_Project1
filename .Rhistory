fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.eff(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.eff(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label=labels,
loc.eff=c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.main.loc),
lapply(labels[11:15], flight.main.loc))
)
# calculate main location effect
main.loc <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(y.bar=mean(!!resp)) %>%
group_by(!!fac) %>%
summarise(mean.y.bar=mean(y.bar)) %>%
mutate(to.add=!!fac*mean.y.bar) %>%
pull(to.add) %>% sum()
}
main.disp <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(lns.2=log(var(!!resp))) %>%
group_by(!!fac) %>%
summarise(mean.lns.2=mean(lns.2)) %>%
mutate(to.add=!!fac*mean.lns.2) %>%
pull(to.add) %>% sum()
}
two.fac.loc <- function(df, fac, resp) {
facs <- strsplit(fac, "")
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.eff(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.eff(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label=labels,
loc.eff=c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.main.loc),
lapply(labels[11:15], flight.main.loc))
)
eff.tbl <- tibble(
label=labels,
loc.eff=c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
a = c("A", "B")
a[1]
sym(a[1])
strspliy("AB", "")
strsplit("AB", "")
strsplit("AB", "")[1]
strsplit("AB", "")[1][1]
strsplit("AB", "")[[1]]
# calculate main location effect
main.loc <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(y.bar=mean(!!resp)) %>%
group_by(!!fac) %>%
summarise(mean.y.bar=mean(y.bar)) %>%
mutate(to.add=!!fac*mean.y.bar) %>%
pull(to.add) %>% sum()
}
main.disp <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(lns.2=log(var(!!resp))) %>%
group_by(!!fac) %>%
summarise(mean.lns.2=mean(lns.2)) %>%
mutate(to.add=!!fac*mean.lns.2) %>%
pull(to.add) %>% sum()
}
two.fac.loc <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.eff(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.eff(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label=labels,
loc.eff=c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
View(eff.tbl)
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
# calculate main location effect
main.loc <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(y.bar=mean(!!resp)) %>%
group_by(!!fac) %>%
summarise(mean.y.bar=mean(y.bar)) %>%
mutate(to.add=!!fac*mean.y.bar) %>%
pull(to.add) %>% sum()
}
main.disp <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(lns.2=log(var(!!resp))) %>%
group_by(!!fac) %>%
summarise(mean.lns.2=mean(lns.2)) %>%
mutate(to.add=!!fac*mean.lns.2) %>%
pull(to.add) %>% sum()
}
two.fac.loc <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.loc(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.loc(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
# calculate main location effect
main.loc <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(y.bar=mean(!!resp)) %>%
group_by(!!fac) %>%
summarise(mean.y.bar=mean(y.bar)) %>%
mutate(to.add=!!fac*mean.y.bar) %>%
pull(to.add) %>% sum()
}
main.disp <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(lns.2=log(var(!!resp))) %>%
group_by(!!fac) %>%
summarise(mean.lns.2=mean(lns.2)) %>%
mutate(to.add=!!fac*mean.lns.2) %>%
pull(to.add) %>% sum()
}
two.fac.loc <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.loc(., facs[1], !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.loc(., facs[1], !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., !!fac1, !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., !!fac1, !!resp)
0.5 * (eff.1 - eff.2)
}
# calculate main location effect
main.loc <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(y.bar=mean(!!resp)) %>%
group_by(!!fac) %>%
summarise(mean.y.bar=mean(y.bar)) %>%
mutate(to.add=!!fac*mean.y.bar) %>%
pull(to.add) %>% sum()
}
main.disp <- function(df, fac, resp) {
# for column selection
fac  <- sym(fac)
resp <- enquo(resp)
# calculate main effect
df %>%
group_by_at(1:5) %>%
summarise(lns.2=log(var(!!resp))) %>%
group_by(!!fac) %>%
summarise(mean.lns.2=mean(lns.2)) %>%
mutate(to.add=!!fac*mean.lns.2) %>%
pull(to.add) %>% sum()
}
two.fac.loc <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor location
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.loc(., facs[1], !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.loc(., facs[1], !!resp)
0.5 * (eff.1 - eff.2)
}
two.fac.disp <- function(df, fac, resp) {
facs <- strsplit(fac, "")[[1]]
fac1 <- sym(facs[1])
fac2 <- sym(facs[2])
resp <- enquo(resp)
# calculate two-factor dispersion
eff.1 <- df %>%
filter(!!fac2>0) %>%
main.disp(., facs[1], !!resp)
eff.2 <- df %>%
filter(!!fac2<0) %>%
main.disp(., facs[1], !!resp)
0.5 * (eff.1 - eff.2)
}
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc))
)
View(eff.tbl)
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.disp),
lapply(labels[11:15], flight.two.fac.disp))
)
View(eff.tbl)
# function wrappers
flight.main.loc     <- function(fac) { main.loc(data, fac, time) }
flight.main.disp    <- function(fac) { main.disp(data, fac, time) }
flight.two.fac.loc  <- function(fac) { two.fac.loc(data, fac, time) }
flight.two.fac.disp <- function(fac) { two.fac.disp(data, fac, time) }
# effect labels
labels=c("A",  "B",  "C",  "D",  "E",
"AB", "AC", "AD", "AE", "BC",
"BD", "BE", "CD", "CE", "DE")
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
loc.disp = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.disp),
lapply(labels[11:15], flight.two.fac.disp))
)
halfnorm(eff.tbl$eff.loc, labs=labels)
halfnorm(eff.tbl$loc.eff, labs=labels)
eff.tbl$loc.eff
halfnorm(unlist(eff.tbl$loc.eff), labs=labels)
# effect table
eff.tbl <- tibble(
label    = labels,
loc.eff  = c(lapply(labels[1:5],   flight.main.loc),
lapply(labels[6:10],  flight.two.fac.loc),
lapply(labels[11:15], flight.two.fac.loc)),
disp.eff = c(lapply(labels[1:5],   flight.main.disp),
lapply(labels[6:10],  flight.two.fac.disp),
lapply(labels[11:15], flight.two.fac.disp))
)
#B nad C appear to be in the top right corner and may be significant
halfnorm(unlist(eff.tbl$disp.eff), labs=labels)
halfnorm(unlist(eff.tbl$loc.eff), labs=labels)
#B nad C appear to be in the top right corner and may be significant
halfnorm(unlist(eff.tbl$disp.eff), labs=labels)
#B nad C appear to be in the top right corner and may be significant
halfnorm(unlist(eff.tbl$disp.eff), labs=eff.tbl$label)
#B nad C appear to be in the top right corner and may be significant
halfnorm(unlist(eff.tbl$disp.eff), labs=unlist(eff.tbl$label))
#B nad C appear to be in the top right corner and may be significant
halfnorm(unlist(eff.tbl$disp.eff), labs=names(labels))
names(loc.effs) <- labels
loc.effs <- unlist(eff.tbl$loc.eff)
names(loc.effs) <- labels
disp.effs <- unlist(eff.tbl$disp.eff)
names(disp.effs) <- labels
halfnorm(loc.effs, labs=names(loc.effs))
halfnorm(disp.effs, labs=names(disp.effs))
